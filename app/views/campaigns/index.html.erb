<%= render 'shared/navbar-main' %>

<div class="wrapper top list">
  <h1>Vos campagnes SMS</h1>
  <div class="right-links">
    <%= link_to "Nouvelle campagne de SMS", new_campaign_path, class: "button green add" %>
  </div>
</div>

<% if @campaigns.any? %>

  <div class="wrapper list">
    <% @campaigns.each do |campaign| %>
      <% if campaign.sent_at.blank? && campaign.scheduled_at.nil? %>
        <div class="list-item">
          <%= image_tag "edit.svg" %>
          <%= link_to campaign.name, name_campaign_path(campaign.id), class: "campaign-link" %>
          <% if campaign.mailing_list %>
            <p><%= campaign.mailing_list.name %> (<%= campaign.mailing_list.contacts.count %><%= " destinataires".pluralize(campaign.mailing_list.contacts.count)%>)</p>
          <% else %>
            <p>Cliquez sur "Modifier" pour ajouter une liste de diffusion.</p>
          <% end %>
          <div class="links">
            <%= link_to "Modifier", name_campaign_path(campaign.id), class: "button grey" %>
          </div>
        </div>
      <% elsif campaign.scheduled_at.present? && campaign.sent_at.nil? %>
        <div class="list-item">
          <%= image_tag "schedule.svg" %>
          <%= link_to campaign.name, name_campaign_path(campaign.id), class: "campaign-link" %>
          <p><strong>Campagne planifiée</strong> le <%= DateTime.parse("#{campaign.scheduled_at}").strftime("%d/%m/%y à %H:%I") %> | <%= campaign.mailing_list.name %> (<%= campaign.mailing_list.contacts.count %><%= " destinataires".pluralize(campaign.mailing_list.contacts.count)%>)</p>
          <div class="links">
            <%= link_to "Modifier", name_campaign_path(campaign.id), class: "button grey" %>
          </div>
        </div>
      <% elsif campaign.sent_at.present? %>
        <div class="list-item">
          <%= image_tag "green-check.svg" %>
          <%= link_to campaign.name, name_campaign_path(campaign.id), class: "campaign-link" %>
          <p><strong>Campagne envoyée</strong> le <%= DateTime.parse("#{campaign.sent_at}").strftime("%d/%m/%y à %H:%I") %> | <%= campaign.mailing_list.name %> (<%= campaign.mailing_list.contacts.count %><%= " destinataires".pluralize(campaign.mailing_list.contacts.count)%>)</p>
        </div>
      <% end %>
    <% end %>
  </div>

<% else %>

  <div class="wrapper hero">
    <%= image_tag "hero-campaign-icon.svg", class: "illustration" %>
    <h2>Commencez votre première campagne !</h2>
    <%= link_to "Nouvelle campagne de SMS", new_campaign_path, class: "button green add" %>
  </div>

<% end %>
